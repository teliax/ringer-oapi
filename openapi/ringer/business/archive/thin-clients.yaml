openapi: 3.0.3
info:
  title: Ringer Business API - Thin Clients
  description: |
    This API provides an endpoint for listing available Thin Clients.
    Thin Clients are nodes that handle call processing for Sites. When configuring a Site,
    a Thin Client needs to be assigned to it. This endpoint helps developers retrieve the list
    of available thin clients to present as options to users.
  version: 1.0.0
  license:
    name: MIT License
    url: https://github.com/teliax/ringer-oapi/blob/main/LICENSE
  contact:
    name: Ringer API Support
    url: https://docs.ringer.tel/support
    email: support@ringer.tel

servers:
  - url: https://api.ringer.tel/v1
    description: Production server
  - url: https://api.staging.ringer.tel/v1
    description: Staging server

# Global security removed

tags:
  - name: Thin Clients
    description: Endpoint for listing available call processing nodes (Thin Clients).

paths:
  /thin-clients:
    get:
      tags:
        - Thin Clients
      summary: List Available Thin Clients
      description: |
        Retrieves a list of all available Thin Clients that can be assigned to Sites.
        This information is typically used during Site setup or modification to select the appropriate call processing node.
      operationId: listAvailableThinClients
      security:
        - oAuth2: [read]
      responses:
        '200':
          description: A list of available Thin Clients.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThinClientListResponse'
              example:
                thin_clients:
                  - id: 11
                    name: "Denver - Bonsai 5"
                    active: true
                    category: "public"
                    ipv4_address: "63.211.239.115"
                    provider: "Teliax Inc."
                    identification: "00-21-5e-96-e3-bc"
                  - id: 12
                    name: "Denver - Bonsai 6"
                    active: true
                    category: "public"
                    ipv4_address: "63.211.239.116"
                    provider: "Teliax Inc."
                    identification: "00-21-5e-96-fe-6c"
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'

components:
  securitySchemes:
    oAuth2:
      type: oauth2
      description: OAuth 2.0 Authentication for securing API endpoints.
      flows:
        clientCredentials:
          tokenUrl: https://api.ringer.tel/v1/auth/token
          scopes:
            read: Read access to API resources
            write: Write access to API resources
            admin: Administrative access.

  schemas:
    ThinClient:
      type: object
      description: Represents an available Thin Client (call processing node).
      properties:
        id:
          type: integer
          format: int64
          description: Unique identifier for the Thin Client.
          example: 11
        name:
          type: string
          description: A descriptive name for the Thin Client (e.g., its location and type).
          example: "Denver - Bonsai 5"
        active:
          type: boolean
          description: Indicates if the Thin Client is currently active and available for assignment.
          example: true
        category:
          type: string
          description: Category of the Thin Client (e.g., public, private).
          example: "public"
        ipv4_address:
          type: string
          format: ipv4
          description: The IPv4 address of the Thin Client.
          example: "63.211.239.115"
        provider:
          type: string
          description: The provider or operator of the Thin Client.
          example: "Teliax Inc."
        identification:
          type: string
          nullable: true
          description: A unique hardware or system identifier for the Thin Client (e.g., MAC address).
          example: "00-21-5e-96-e3-bc"
      required:
        - id
        - name
        - active
        - category
        - ipv4_address
        - provider
      example:
        id: 11
        name: "Denver - Bonsai 5"
        active: true
        category: "public"
        ipv4_address: "63.211.239.115"
        provider: "Teliax Inc."
        identification: "00-21-5e-96-e3-bc"

    ThinClientListResponse:
      type: object
      description: A list of available Thin Clients.
      properties:
        thin_clients:
          type: array
          items:
            $ref: '#/components/schemas/ThinClient'
      required:
        - thin_clients
      example:
        thin_clients:
          - id: 11
            name: "Denver - Bonsai 5"
            active: true
            category: "public"
            ipv4_address: "63.211.239.115"
            provider: "Teliax Inc."
            identification: "00-21-5e-96-e3-bc"
          - id: 12
            name: "Denver - Bonsai 6"
            active: true
            category: "public"
            ipv4_address: "63.211.239.116"
            provider: "Teliax Inc."
            identification: "00-21-5e-96-fe-6c"

    Error:
      type: object
      description: Standard error response format.
      properties:
        status:
          type: string
          example: "error"
        error:
          type: string
          example: "Failed to retrieve thin client list."
        error_code:
          type: string
          example: "THIN_CLIENT_LIST_ERROR"
      required:
        - status
        - error
        - error_code
      example:
        status: "error"
        error: "An error occurred with thin clients."
        error_code: "THIN_CLIENT_ERROR"

  responses:
    UnauthorizedError:
      description: Unauthorized - Authentication token is missing, invalid, or does not have permissions for this resource.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            status: "error"
            error: "Authentication required for thin clients."
            error_code: "UNAUTHORIZED_THIN_CLIENTS"
    ForbiddenError:
      description: Forbidden - The authenticated user does not have the necessary permissions to perform this action.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            status: "error"
            error: "Permission denied for thin clients."
            error_code: "FORBIDDEN_THIN_CLIENTS"

# Removed duplicated securitySchemes block
# securitySchemes:
#   oAuth2:
#     type: oauth2
#     description: OAuth 2.0 Authentication for securing API endpoints.
#     flows:
#       clientCredentials:
#         tokenUrl: https://api.ringer.tel/v1/auth/token
#         scopes:
#           read: Read access to API resources
#           write: Write access to API resources
#           admin: Administrative access. 
