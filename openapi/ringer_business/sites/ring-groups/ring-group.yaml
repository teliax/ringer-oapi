openapi: 3.0.3
info:
  title: Ringer Business API - Site Ring Group (Individual Operations)
  description: |
    Endpoints for retrieving, updating, and deleting individual ring groups associated with a specific site.
  version: 1.0.0
  license:
    name: MIT License
    url: https://github.com/teliax/ringer-oapi/blob/main/LICENSE
  contact:
    name: Ringer API Support
    url: https://docs.ringer.tel/support
    email: support@ringer.tel

servers:
  - url: https://api.ringer.tel/v1
    description: Production server
  # - url: https://api.staging.ringer.tel/v1
  #   description: Staging server

tags:
  - name: Site Features - Ring Groups # Standardized tag
    description: "Managing ring groups for a site."

paths:
  /sites/{siteId}/ring-groups/{ringGroupId}: # Standardized params
    parameters:
      - $ref: '../../common_components.yaml#/components/parameters/SiteId'
      - $ref: './index.yaml#/components/parameters/RingGroupIdPath'
    get:
      tags:
        - Site Features - Ring Groups
      summary: Get Ring Group Details
      description: Retrieves detailed information for a specific ring group by its ID.
      operationId: getSiteRingGroupById # Renamed
      security:
        - oAuth2: [read]
      responses:
        '200':
          description: Ring Group details retrieved successfully.
          content:
            application/json:
              schema:
                $ref: './index.yaml#/components/schemas/RingGroupResponse' # Referenced from index
              example:
                id: 10
                site_id: 6
                name: "Sales Team"
                destination_codes: ["device:dev101", "extension:ext102"]
                destinations:
                  - name: "John Smith (device:dev101)" # Example expanded destination
                    code: "device:dev101"
                  - name: "Jane Doe (extension:ext102)"
                    code: "extension:ext102"
                ring_strategy: "simultaneous"
                timeout: 30
                fail_over_destination:
                  name: "Sales Voicemail (voicemailbox:vm_sales)"
                  code: "voicemailbox:vm_sales"
                user_id: null
                links:
                  - href: "/sites/6/ring-groups/10"
                    rel: "self"
                    method: "GET"
        '401':
          $ref: '../../common_components.yaml#/components/responses/UnauthorizedError'
        '403':
          $ref: '../../common_components.yaml#/components/responses/ForbiddenError'
        '404':
          $ref: '../../common_components.yaml#/components/responses/NotFoundError'
    
    put:
      tags:
        - Site Features - Ring Groups
      summary: Update Ring Group Configuration
      description: Updates an existing ring group. Provide only fields to be changed.
      operationId: updateSiteRingGroupById # Renamed
      security:
        - oAuth2: [write]
      requestBody:
        description: Ring group attributes to update.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RingGroupUpdateRequest'
            example:
              name: "Sales & Support Combined"
              destination_codes: ["device:dev101", "extension:ext_support"]
              ring_strategy: "sequential"
              timeout: 25
              fail_over_destination_code: "menu:main_company_menu"
      responses:
        '200':
          description: Ring Group Updated Successfully.
          content:
            application/json:
              schema:
                $ref: './index.yaml#/components/schemas/RingGroupResponse' # Referenced from index
              example:
                id: 10
                site_id: 6
                name: "Sales & Support Combined"
                destination_codes: ["device:dev101", "extension:ext_support"]
                destinations:
                  - name: "Sales Phone 1"
                    code: "device:dev101"
                  - name: "Support Ext"
                    code: "extension:ext_support"
                ring_strategy: "sequential"
                timeout: 25
                fail_over_destination:
                  name: "Main Company Menu"
                  code: "menu:main_company_menu"
                user_id: null
                links:
                  - href: "/sites/6/ring-groups/10"
                    rel: "self"
                    method: "GET"
        '400':
          $ref: '../../common_components.yaml#/components/responses/BadRequestError'
        '401':
          $ref: '../../common_components.yaml#/components/responses/UnauthorizedError'
        '403':
          $ref: '../../common_components.yaml#/components/responses/ForbiddenError'
        '404':
          $ref: '../../common_components.yaml#/components/responses/NotFoundError'
    
    delete:
      tags:
        - Site Features - Ring Groups
      summary: Delete Ring Group
      description: Permanently deletes a specific ring group.
      operationId: deleteSiteRingGroupById # Renamed
      security:
        - oAuth2: [write]
      responses:
        '204':
          description: Ring Group Deleted Successfully.
        '401':
          $ref: '../../common_components.yaml#/components/responses/UnauthorizedError'
        '403':
          $ref: '../../common_components.yaml#/components/responses/ForbiddenError'
        '404':
          $ref: '../../common_components.yaml#/components/responses/NotFoundError'

components:
  securitySchemes:
    oAuth2:
      $ref: '../../common_components.yaml#/components/securitySchemes/oAuth2'

  parameters:
    ringGroupId: # Defined locally
      name: ringGroupId
      in: path
      description: The unique identifier of the ring group.
      required: true
      schema:
        type: integer
        format: int64
        example: 10

  schemas:
    RingGroupUpdateRequest: # For PUT, fields are typically optional if behaving like PATCH
      type: object
      description: Attributes for updating a ring group. Only provide fields to be changed.
      properties:
        name:
          type: string
          nullable: true
        destination_codes: 
          type: array
          items:
            type: string
          nullable: true
        ring_strategy:
          type: string
          enum: [simultaneous, sequential, random]
          nullable: true
        timeout:
          type: integer
          nullable: true
        fail_over_destination_code:
          type: string
          nullable: true
        user_id:
          type: integer
          format: int64
          nullable: true
          description: Optional. Identifier of a user primarily associated with this ring group.
          example: 10
      example:
        name: "Billing Department RG"
        destination_codes: ["user:billing_agent1", "user:billing_agent2"]
        ring_strategy: "simultaneous"
        timeout: 15

    # RingGroupResponse is referenced from ./index.yaml#/components/schemas/RingGroupResponse
    # Common Link and Error schemas are referenced from ../../../components/ 